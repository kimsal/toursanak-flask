{% include 'admin/header.html' %} 
<style type="text/css">
  .show{
    display: block
  }
  .hide{
    display: block;
  }
  .other_image{
    height:50px;
    background-color:#79aec8;
    color:white;
    font-weight:bold;
    line-height:50px;
  }
  .more{
    color:#447e9b;
    font-weight: bold;
    cursor: pointer;
    margin-top:10px;
  }
  .more:hover{
    color:#036;
  }
  .delete{
    color:red;
    cursor: pointer;
    padding-left:10px;
    font-weight: bold;
    text-align: right;
  }
  .delete:hover{
    color:#E88;

  }
  tr td img{
    margin-top:10px;
  }
  input[type="file"] {
    display: block;
    margin-right: 5px;
  }
</style>
<script type="text/javascript">
  var img_no=0;
</script>
  <div id="page-content-wrapper">
      <div class="container-fluid">
          <div class="row">
              <div class="col-lg-12" style="padding:0px;">
                    <br><br>
                  <div class="panel panel-default" style="padding:0px;">
                    <div class="panel-heading">
                      <a href="/admin/post/add" class="btn btn-default btn-sm pull-right">
                        <i class="fa fa-plus-circle" aria-hidden="true"></i>
                        New 
                     </a>
                      <h4 class="panel-title">
                        <a href="#menu-toggle" style="border:none;font-size:20px;" class="" id="menu-toggle">
                        <i class="fa fa-arrow-circle-o-left hidden-sm hidden-md hidden-lg " aria-hidden="true"></i>
                        </a>
                         Post Form
                      </h4>
                    </div>
                    <div class="panel-body" >
                      <div class="table-responsive" style="border:none;">
                          <!--form upload-->
                          <div class="col-md-12 col-xs-12 col-md-12 col-lg-12" >
                          <br/>
                              <form class="form-horizontal" action="/admin/post/add/" method="POST" id="frm" enctype="multipart/form-data">
                              {% with messages = get_flashed_messages() %}
                                {% if messages %}
                                  {% for message in messages %}
                                    <li class="alert alert-warning"> 
                                      {{ message }}
                                    </li>
                                  {% endfor %}
                                {% endif %}
                              {% endwith %}
                                <!-- input title-->
                               {{ form.hidden_tag() }}
                                <div class="form-group">
                                  <div class="col-xs-12 col-sm-3 col-md-2 col-lg-2">
                                    {{ form.title.label }}
                                    </div>
                                    <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                                      {{ form.title(class_="form-control") }}
                                    </div>
                                </div>
                                <div class="form-group">
                                  <div class="col-xs-12 col-sm-3 col-md-2 col-lg-2">
                                    {{ form.keyword.label }}
                                    </div>
                                    <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                                      {{ form.keyword(class_="form-control") }}
                                    </div>
                                </div>
                                <div class="form-group">
                                  <div class="col-xs-12 col-sm-3 col-md-2 col-lg-2">
                                    {{ form.short_description.label }}
                                    </div>
                                    <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                                      {{ form.short_description(class_="form-control",rows="4") }}
                                    </div>
                                </div>
                                <div class="form-group">
                                   <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                                    <!-- <input id="name" name="name" type="text" placeholder="Type your title here..." class="form-control"> -->
                                    {{ form.description.label }}
                                    </div>
                                    <div class="col-xs-12 col-sm-12 col-md-11 col-lg-11">
                                      {{ form.description(class_="form-control ckeditor",id="description") }}
                                    </div>
                                    
                                  
                                     <script type="text/javascript">
                                        CKEDITOR.replace("description", {
                                            filebrowserUploadUrl: '/admin/ckupload/',
                                            filebrowserImageUploadUrl: '/ckupload/'
                                        });
                                    </script>
                                </div>
                                <!--select box-->
                                <div class="form-group">
                                  <div class="col-xs-12 col-sm-3 col-md-2 col-lg-2"><br/>
                                    <!-- <input id="name" name="name" type="text" placeholder="Type your title here..." class="form-control"> -->
                                    {{ form.category_id.label }}
                                  </div>
                                  <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                                    <br/>
                                    {{ form.category_id(class_="form-control") }}

                                  </div>
                                </div>
                                <div class="form-group hide mydate" style="display: none;">
                                  <div class="col-xs-12 col-sm-3 col-md-2 col-lg-2"><br/>
                                    Date
                                  </div>
                                  <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                                    <br/>

                                    <select  class="form-control" name="day" style="width:20%;display: inline;">
                                      {%for i in range(1,32)%}
                                          <option value="{{i}}">
                                            {{i}}
                                          </option>
                                      {%endfor%}
                                   </select>


                                   <select  class="form-control" name="month" style="width:33%;display: inline;">
                                      <option value="January">
                                        January
                                      </option>
                                      <option value="Febraury">
                                        Febraury
                                      </option>
                                      <option value="March">
                                        March 
                                      </option>
                                      <option value="April">
                                        April
                                      </option>
                                      <option value="May">
                                        May
                                      </option>
                                      <option value="June">
                                        June
                                      </option>
                                      <option value="7">
                                        July
                                      </option>
                                      <option value="August">
                                        August
                                      </option>
                                      <option value="September">
                                        September
                                      </option>
                                      <option value="10">
                                        October
                                      </option>
                                      <option value="November">
                                        November
                                      </option>
                                      <option value="December">
                                        December
                                      </option>

                                   </select> 

                                   <select  class="form-control" name="year" style="width:33%;display: inline;">
                                      <option value="2017">
                                        2017
                                      </option>
                                      <option  value="2018">
                                        2018
                                      </option>
                                      <option value="2019">
                                        2019
                                      </option>
                                      <option value="2020">
                                        2020
                                      </option>
                                      <option value="2021">
                                        2021
                                      </option>
                                      <option value="2022">
                                        2022
                                      </option>
                                      <option value="2023">
                                        2023
                                      </option>
                                    </select>
                                  </div>
                                </div>
                                <div class="form-group">
                                  <div class="col-xs-12 col-sm-3 col-md-2 col-lg-2">
                                    {{ form.price.label }}
                                    </div>
                                    <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                                      {{ form.price(class_="form-control price") }}
                                    </div>
                                </div>
                                <div class="form-group">
                                  <div class="col-xs-12 col-sm-3 col-md-2 col-lg-2">
                                    {{ form.map.label }}
                                    </div>
                                    <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                                      {{ form.map(class_="form-control",rows="5") }}
                                    </div>
                                </div>
                                
                                
                                <!-- add feature image-->

                                <div class="form-group">
                                  <div class="col-xs-12 col-sm-3 col-md-2 col-lg-2"><br/>
                                    <label>Feature Image</label>
                                  </div>

                                  <input type="text" name="txt_temp_image" class="txt_temp_image" value="" style="display:none"/>

                                  <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                                     <div class="panel panel-body">
                                       <div class="span4 cropme" id="" style="width:200px; height: 150px;">
                                        <input type="file" name="feature_image" id="feature_image" style="display:none;">
                                          <img src="/static/images/no image.jpg" class="img-responsive" id="feature_image"/>
                                       </div>
                                    </div>
                                  </div>
                                </div>
                                <!--end phos add feature image -->
                                <div class="form-group">
                                  <div class="col-md-12 col-xs-12 co-md-12 col-lg-12 other_image">
                                    More Images (optional)
                                  </div>
                                </div>
                                <div class="form-group">
                                  <div class="col-xs-12 col-sm-6 col-md-6 ol-lg-6">
                                  <table id="imgs">
                                    <tr>
                                      <td>
                                        <input class="btn btn-default" type="file" name="other_image[]" multiple=""  class="other_image1"/>
                                      </td>
                                      <td>
                                      <img src="/static/images/no image.jpg" class="img-1 img-responsive" style="max-width:100px;">
                                      </td>
                                      <td>
                                      <input type="text" value="" name="image1" style="display:none;" />
                                      </td>
                                      <td class="delete delete1" onclick="removeImage(1)">
                                         <input type="checkbox" name="remove1" id="rm1"/>Remove
                                      </td>
                                    </tr>
                                    </table>
                                    <div class="more">
                                      <i class="fa fa-plus" aria-hidden="true" style="color:blue"></i>
                                      <label>
                                            Add another image
                                      </label>
                                    </div>
                                    </div>
                                  </div>
                                <!--end feature image-->
                                <!-- Form actions -->
                                <div class="form-group">
                                  <div class="col-md-12 text-right">
                                    <center>
                                      <button type="submit" class="btn btn-default btn-sm btn-primary">
                                       <!-- onclick="getAllRemoveImages();"> -->
                                        <i class="fa fa-upload" aria-hidden="true"></i>
                                          Save
                                        </button>
                                      <button type="reset" class="btn btn-default btn-sm">
                                      <i class="fa fa-ban" aria-hidden="true"></i>
                                        Cancel
                                      </button>
                                    </center>
                                  </div>
                                </div>
                                <input type="text" value="" name="all_removed_images" style="display:none;" />
                              </form>
                            
                          </div>
                          <!--end form upload-->
                      </div> 
                    </div>
                  </div>

                  
              </div>
          </div>
      </div>
  </div>
<!-- /#page-content-wrapper -->
</div>

    <!-- Menu Toggle Script -->
<script type="text/javascript" src="/static/admin/js/postform.js"></script>
<script type="text/javascript">
  var feature_image='';
</script>
  {% for p in post %}
  <script type="text/javascript">
   $('input#title').attr('value',"{{p.title|safe}}"); 
   $('#frm').attr('action','/admin/post/edit/{{p.slug}}/');
   $('#description').html("{{p.description.replace('\n', '').replace('\r','')}}");  
   $('select#category_id option[value="{{p.category_id}}"]').attr("selected","selected");

    $('select[name="day"] option[value="{{p.day}}"]').attr('selected',"selected");
   $('select[name="month"] option[value="{{p.month}}"]').attr('selected',"selected");
   $('select[name="month"] option[value="{{p.month}}"]').attr('selected',"selected");
   $('select[name="year"] option[value="{{p.year}}"]').attr('selected',"selected");



   feature_image="{{p.feature_image}}";

   $("#landscape").html('<img src="/static/images/images/'+feature_image+'" class="img-responsive"/>');
   $(".txt_temp_image").attr('value',feature_image);
   $("#duration").attr('value',"{{p.duration}}");
   $("input#price").attr('value',"{{p.price}}");
   $("#location").attr('value',"{{p.location}}");
   $("#file").attr('value',"{{p.file}}");
   $("#landscape img").addClass("img-responsive");
   $('#keyword').html("{{p.keyword.replace('\n', '').replace('\r','')}}"); 


   //Load other images:
   loadOldImages("{{p.images}}");
   $("#short_description").html("{{p.short_description}}");
   $("#price").attr('value',"{{p.price}}");
   $("#map").html("{{p.map}}");

   if($('select[id="category_id"] option:selected').text().trim()==='Upcoming'){
    $('.mydate').removeClass('hide');
    $('.mydate').addClass('show');
  }

 </script>
{% endfor %}
<script type="text/javascript">
  if(feature_image==''){
    feature_image='/static/images/no image.jpg';
   }

   $("img#feature_image").attr('src','/static/images/images/'+feature_image);
  //input only number
    $("#price").keydown(function (e) {
        // Allow: backspace, delete, tab, escape, enter and .
        if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
             // Allow: Ctrl+A, Command+A
            (e.keyCode == 65 && ( e.ctrlKey === true || e.metaKey === true ) ) || 
             // Allow: home, end, left, right, down, up
            (e.keyCode >= 35 && e.keyCode <= 40)) {
                 // let it happen, don't do anything
                 return;
        }
        // Ensure that it is a number and stop the keypress
        if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
            e.preventDefault();
        }
    });
  //Other images
  </script>
  <script type="text/javascript" src="/static/admin/js/postform2.js">
</script>
{% include 'admin/footer.html' %} 
<script type="text/javascript">
  //feature image
   function readURL1(input) {

    if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function (e) {
            $('img#feature_image').attr('src', e.target.result);
        }

        reader.readAsDataURL(input.files[0]);
    }
}

$('input#feature_image').change(function(){
    readURL1(this);
});
$('img#feature_image').click(function(){
  $("input#feature_image").click();
});


// control date month year for upcomming only


$('select[id="category_id"]').change(function(){
  if($('select[id="category_id"] option:selected').text().trim()==='Upcomming'){
    $('.mydate').removeClass('hide');
    $('.mydate').addClass('show');
  }
  else{
    $('.mydate').removeClass('show');
    $('.mydate').addClass('hide');
  }
});
</script>

{% include 'admin/footer.html' %} 
